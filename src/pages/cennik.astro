---
import MainLayout from "../layouts/MainLayout.astro";
import CTASection from "../components/CTASection.astro";
import MonthlyCalculator from "../components/MonthlyCalculator.astro";
import PricingTable from "../components/PricingTable.astro";
import { PRICING_DATA, formatPLN } from "../data/pricing";
import {
  BRAND_NAME,
  CTA_PRIMARY_HREF,
  CTA_PRIMARY_LABEL,
  CTA_PRIMARY_REL,
  CTA_PRIMARY_TARGET,
  OTHER_LANG_PRICE_1ON1_FROM,
  OTHER_LANG_PRICE_GROUP_FROM,
  getEnrollmentMessage,
  generateBreadcrumbSchema,
} from "../config/site";

const title = `Cennik â€“ kursy jÄ™zykowe i matematyka w Legionowie | ${BRAND_NAME}`;
const description =
  "SprawdÅº ceny kursÃ³w angielskiego i matematyki w Legionowie. Lekcje stacjonarne i online, 1:1, mini-grupy i kursy grupowe.";

const steps = [
  "Podaj poziom i cel nauki",
  "Wybierz preferowany format (1:1 / mini-grupa)",
  "Dostaniesz propozycjÄ™ planu i cenÄ™",
];

const packageColumns = [
  "Czas lekcji",
  "Liczba osÃ³b",
  "Cena / spotkanie",
  "Pakiet 10 spotkaÅ„ / osoba",
  "Szacunkowo / mies. (4 spotkania)",
];

const packageRows = PRICING_DATA.packages.flatMap((plan) => {
  const persons = Object.keys(plan.pricePerPerson)
    .map((value) => Number(value))
    .sort((a, b) => a - b);
  return persons.map((count) => {
    const total = plan.pricePerPerson[count];
    const perSession = total / plan.baseSessions;
    const perMonth = perSession * 4;
    return [
      `${plan.minutes} min`,
      `${count} os.`,
      formatPLN(perSession),
      `${formatPLN(total)} / osoba`,
      formatPLN(perMonth),
    ];
  });
});

const courseColumns = [
  "Kurs grupowy",
  "Czas spotkania",
  "Liczba spotkaÅ„",
  "Cena / osoba",
  "Cena / spotkanie",
  "Min. grupa",
];

const courseRows = PRICING_DATA.courses.map((course) => {
  const perSession = course.price / course.sessions;
  return [
    course.label,
    `${course.minutes} min`,
    `${course.sessions}`,
    `${formatPLN(course.price)} / osoba`,
    formatPLN(perSession),
    `od ${course.minPersons} osÃ³b`,
  ];
});

const packageFootnote =
  "Szacunek miesiÄ™czny zakÅ‚ada 4 tygodnie nauki i odnosi siÄ™ do pakietÃ³w 10 spotkaÅ„.";
const courseFootnote = "Kursy grupowe majÄ… staÅ‚Ä… liczbÄ™ spotkaÅ„ i cenÄ™ za osobÄ™.";
const enrollmentMessage = getEnrollmentMessage();

const hasOtherLangPricing =
  typeof OTHER_LANG_PRICE_1ON1_FROM === "number" ||
  typeof OTHER_LANG_PRICE_GROUP_FROM === "number";
const otherLangPricing = [
  ...(typeof OTHER_LANG_PRICE_1ON1_FROM === "number"
    ? [{ label: "Lekcje 1:1 od", value: formatPLN(OTHER_LANG_PRICE_1ON1_FROM) }]
    : []),
  ...(typeof OTHER_LANG_PRICE_GROUP_FROM === "number"
    ? [{ label: "Mini-grupy od", value: formatPLN(OTHER_LANG_PRICE_GROUP_FROM) }]
    : []),
];

const faq = [
  {
    question: "Jak liczymy ceny w tabeli i kalkulatorze?",
    answer:
      "Pakiety bazujÄ… na 10 spotkaniach, a kalkulator miesiÄ™czny przyjmuje 4 tygodnie w miesiÄ…cu. Kursy grupowe majÄ… staÅ‚Ä… liczbÄ™ spotkaÅ„ i cenÄ™ / osobÄ™.",
  },
  {
    question: "Jak rozliczane sÄ… kursy grupowe?",
    answer:
      "Kursy majÄ… staÅ‚Ä… liczbÄ™ spotkaÅ„ i cenÄ™ za osobÄ™ zgodnie z cennikiem (30Ã—90 lub 56Ã—60/90 min). Minimalna liczba osÃ³b wynika z cennika.",
  },
  {
    question: "Czy matematyka kosztuje tyle samo co angielski?",
    answer: "Tak, matematyka jest wyceniana wedÅ‚ug tych samych stawek co angielski.",
  },
];

const faqJsonLd = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  mainEntity: faq.map((item) => ({
    "@type": "Question",
    name: item.question,
    acceptedAnswer: {
      "@type": "Answer",
      text: item.answer,
    },
  })),
};

const breadcrumbSchema = generateBreadcrumbSchema([
  { name: "Strona gÅ‚Ã³wna", url: "/" },
  { name: "Cennik" },
]);

const notice = "rounded-xl border border-primary/10 bg-primary/5 p-4 text-primary";
---

<MainLayout
  title={title}
  description={description}
  canonical="/cennik"
  structuredData={[faqJsonLd, breadcrumbSchema]}
>
  <section class="bg-hero-gradient">
    <div class="mx-auto w-full max-w-7xl px-6 py-10 sm:py-14">
      <div class="grid gap-8 lg:grid-cols-2 lg:items-center">
        <div>
          <span class="kicker">Cennik</span>
          <h1 class="mt-4">Cennik zajÄ™Ä‡ jÄ™zykowych i matematyki w Legionowie</h1>
          <p class="mt-4 max-w-2xl text-lg">
            Cena zaleÅ¼y od formatu zajÄ™Ä‡ (stacjonarnie/online), dÅ‚ugoÅ›ci spotkaÅ„ i czÄ™stotliwoÅ›ci.
            PoniÅ¼ej znajdziesz orientacyjne warianty, a szczegÃ³Å‚y ustalamy po krÃ³tkiej rozmowie.
          </p>
          <p class="mt-4 text-xs font-semibold uppercase tracking-widest text-slate-500">
            Cennik aktualny na rok 2025/2026
          </p>
          <p class="mt-4 text-sm text-slate-600">Matematyka ma takie same stawki jak angielski.</p>
          {
            hasOtherLangPricing ? (
              <div class="mt-4 grid gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm text-slate-600 sm:grid-cols-2">
                {otherLangPricing.map((item) => (
                  <div>
                    <div class="text-xs font-bold uppercase tracking-widest text-slate-500">
                      {item.label}
                    </div>
                    <div class="mt-2 text-lg font-bold text-slate-900">{item.value}</div>
                  </div>
                ))}
              </div>
            ) : (
              <p class="mt-2 text-sm text-slate-600">
                PozostaÅ‚e jÄ™zyki: wycena indywidualna â€” zaleÅ¼na od lektora i formy zajÄ™Ä‡.
              </p>
            )
          }
          <div class="mt-6 rounded-2xl border border-primary/20 bg-primary/5 p-4">
            <div class="text-sm font-bold text-primary">Polski dla obcokrajowcÃ³w</div>
            <div class="mt-2 grid gap-2 text-sm text-slate-700">
              <div><strong>Lekcje 1:1:</strong> 60 min â†’ 130 zÅ‚, 45 min â†’ 100 zÅ‚</div>
              <div><strong>Grupy:</strong> 2 os. â†’ 85 zÅ‚/os., 3 os. â†’ 70 zÅ‚/os., 4 os. â†’ 55 zÅ‚/os.</div>
            </div>
            <a class="mt-3 inline-flex text-sm font-semibold text-primary hover:underline" href="/polski-dla-obcokrajowcow">
              Dowiedz siÄ™ wiÄ™cej â†’
            </a>
          </div>
          <div class="mt-8 flex flex-wrap gap-3">
            <a class="btn btn-secondary" href="/cennik-lingua.pdf" download>
              <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path
                  fill-rule="evenodd"
                  d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"
                  clip-rule="evenodd"></path>
              </svg>
              Pobierz cennik (PDF)
            </a>
          </div>
          <div class={`mt-6 ${notice} text-sm`}>
            {enrollmentMessage}
          </div>
        </div>

        <div class="card p-6 sm:p-8">
          <h2 class="text-lg font-bold tracking-tight">Jak uzyskaÄ‡ dokÅ‚adnÄ… wycenÄ™</h2>
          <ol class="mt-6 space-y-4 text-sm text-slate-600">
            {steps.map((step, index) => (
              <li class="flex items-start gap-3">
                <span class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-primary/10 text-xs font-bold text-primary">
                  {index + 1}
                </span>
                <span class="pt-0.5">{step}</span>
              </li>
            ))}
          </ol>
        </div>
      </div>
    </div>
  </section>

  <section class="py-10 lg:py-14">
    <div class="mx-auto w-full max-w-7xl px-6">
      <h2>Jasne ceny za lekcje i pakiety</h2>
      <p class="mt-3 max-w-3xl text-slate-600">
        W tabelach znajdziesz ceny za spotkanie, pakiet 10 spotkaÅ„ oraz szacunkowy koszt miesiÄ™czny.
        Kalkulator obok pozwala szybko policzyÄ‡ wariant dopasowany do Twojego grafiku.
      </p>

      <div class="mt-6 grid gap-6 lg:grid-cols-[minmax(0,1fr)_minmax(0,0.85fr)] lg:items-start">
        <div class="space-y-6">
          <PricingTable
            title="Pakiety indywidualne i mini-grupy"
            subtitle="Ceny / osoba dla angielskiego i matematyki."
            columns={packageColumns}
            rows={packageRows}
            footnote={packageFootnote}
          />
          <PricingTable
            title="Kursy grupowe"
            subtitle="StaÅ‚e programy grupowe z ustalonÄ… liczbÄ… spotkaÅ„."
            columns={courseColumns}
            rows={courseRows}
            footnote={courseFootnote}
          />
        </div>
        <MonthlyCalculator />
      </div>

      <div class="mt-8">
        <a class="btn btn-secondary" href="/cennik-lingua.pdf" download>
          <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path
              fill-rule="evenodd"
              d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"
              clip-rule="evenodd"></path>
          </svg>
          Pobierz peÅ‚ny cennik (PDF)
        </a>
      </div>
    </div>
  </section>

  <section class="py-10 lg:py-14">
    <div class="mx-auto w-full max-w-7xl px-6">
      <h2>Jak dziaÅ‚a wycena</h2>
      <div class="mt-6 grid gap-4 md:grid-cols-3">
        {
          faq.map((item) => (
            <div class="card p-6">
              <div class="text-sm font-semibold text-slate-900">{item.question}</div>
              <p class="mt-3 text-sm text-slate-600">{item.answer}</p>
            </div>
          ))
        }
      </div>
      <p class="mt-6 text-xs text-slate-400">
        Cennik oparty o PDF na sezon 2025/2026. JeÅ›li potrzebujesz indywidualnej wyceny, skontaktuj
        siÄ™ z nami.
      </p>
    </div>
  </section>

  <section class="py-10 lg:py-14" id="polecenie">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="rounded-2xl border border-primary/20 bg-gradient-to-br from-primary/5 via-white to-primary/10 p-6 lg:p-10">
        <div class="grid gap-8 lg:grid-cols-2 lg:items-center">
          <div>
            <span class="text-4xl" aria-hidden="true">ğŸ</span>
            <h2 class="mt-4 text-2xl font-bold text-slate-900">Program poleceÅ„</h2>
            <p class="mt-2 text-lg text-primary font-semibold">Za polecenie nowego ucznia â€“ 2 lekcje w prezencie!</p>
            <p class="mt-4 text-slate-600">
              JeÅ›li jesteÅ› naszym kursantem i polecisz szkoÅ‚Ä™ znajomemu, ktÃ³ry rozpocznie u nas naukÄ™,
              oboje otrzymacie bonus: Ty dostajesz <strong>2 darmowe lekcje</strong>, a nowy uczeÅ„
              rozpoczyna naukÄ™ z najlepszymi rekomendacjami.
            </p>
          </div>
          <div class="card p-6">
            <h3 class="text-base font-bold text-slate-900">Jak to dziaÅ‚a?</h3>
            <ol class="mt-4 space-y-3 text-sm text-slate-600">
              <li class="flex items-start gap-3">
                <span class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-primary/10 text-xs font-bold text-primary">1</span>
                <span>PoleÄ‡ nas znajomemu, rodzinie lub wspÃ³Å‚pracownikowi.</span>
              </li>
              <li class="flex items-start gap-3">
                <span class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-primary/10 text-xs font-bold text-primary">2</span>
                <span>Nowy uczeÅ„ zapisuje siÄ™ na zajÄ™cia i podaje Twoje imiÄ™ jako osobÄ™ polecajÄ…cÄ….</span>
              </li>
              <li class="flex items-start gap-3">
                <span class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-primary/10 text-xs font-bold text-primary">3</span>
                <span>Po opÅ‚aceniu pierwszego pakietu przez nowego ucznia, dostajesz <strong>2 lekcje gratis</strong>!</span>
              </li>
            </ol>
            <p class="mt-4 text-xs text-slate-500">
              Nie ma limitu poleceÅ„ â€“ im wiÄ™cej osÃ³b polecisz, tym wiÄ™cej darmowych lekcji otrzymasz.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <CTASection
    title="Chcesz dokÅ‚adny plan i cenÄ™ dla siebie?"
    description="Napisz, jaki masz poziom, cel i preferowane godziny â€” przygotujemy propozycjÄ™ pakietu."
  />
</MainLayout>
