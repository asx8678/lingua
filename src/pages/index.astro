---
import MainLayout from "../layouts/MainLayout.astro";
import CTASection from "../components/CTASection.astro";
import TestimonialCard from "../components/TestimonialCard.astro";
import TrustSection from "../components/TrustSection.astro";
import FaqSection from "../components/FaqSection.astro";
import { taughtLanguages } from "../data/subjects";
import testimonials from "../data/testimonials.json";
import {
  BRAND_NAME,
  BUSINESS,
  SITE_URL,
  CONTACT_EMAIL,
  CONTACT_PHONE,
} from "../config/site";

const languagesGenitive = taughtLanguages.map(lang => {
  const genitiveMap: Record<string, string> = {
    "Angielski": "angielskiego",
    "Francuski": "francuskiego",
    "Hiszpa≈Ñski": "hiszpa≈Ñskiego",
    "Niemiecki": "niemieckiego",
    "Rosyjski": "rosyjskiego",
    "Szwedzki": "szwedzkiego",
    "Polski dla obcokrajowc√≥w": "polskiego dla obcokrajowc√≥w"
  };
  return genitiveMap[lang] || lang;
});

const languagesList = new Intl.ListFormat("pl", {
  style: "long",
  type: "conjunction",
}).format(languagesGenitive);

const title = `Szko≈Ça jƒôzykowa Legionowo | ${BRAND_NAME} ‚Äì jƒôzyki i matematyka`;
const description =
  "Szko≈Ça jƒôzykowa w Legionowie ‚Äì angielski, niemiecki, francuski i 4 inne jƒôzyki + matematyka. Zajƒôcia stacjonarne i online. Um√≥w bezp≈ÇatnƒÖ konsultacjƒô!";

const offerCards = [
  {
    title: "Angielski stacjonarnie",
    text: "Zajƒôcia twarzƒÖ w twarz w Legionowie. Bezpo≈õredni kontakt i pe≈Çna koncentracja.",
    href: "/angielski-stacjonarnie",
    featured: true,
  },
  {
    title: "Angielski online",
    text: "Lekcje zdalne z lektorem na ≈ºywo. Elastyczne godziny i nacisk na m√≥wienie.",
    href: "/angielski-online",
    featured: false,
  },
];

const steps = [
  {
    title: "Rozmowa i diagnoza",
    text: "Poznajemy Tw√≥j cel, poziom i preferowany tryb zajƒôƒá. Ustalamy priorytety.",
  },
  {
    title: "Plan nauki i materia≈Çy",
    text: "Dostajesz plan na 4‚Äì12 tygodni z konkretnymi tematami, s≈Çownictwem i ƒáwiczeniami.",
  },
  {
    title: "Lekcje + feedback",
    text: "Na zajƒôciach m√≥wisz od pierwszych minut. Po lekcji dostajesz wskaz√≥wki i zadania.",
  },
];

const highlights = [
  "Plan na 4‚Äì12 tygodni",
  "Feedback po ka≈ºdej lekcji",
  "Stacjonarnie (Legionowo) i online",
];

const subjectChips = ["Angielski", "Inne jƒôzyki", "Matematyka"];

const reviewCount = testimonials.length;
const reviewAverage = reviewCount
  ? (testimonials.reduce((sum, item) => sum + item.rating, 0) / reviewCount).toFixed(1)
  : "‚Äî";

const proofPoints = [
  {
    label: "Ocena kursant√≥w",
    value: `${reviewAverage}/5`,
    note: `Na podstawie ${reviewCount} opinii na stronie`,
  },
  {
    label: "Diagnoza + plan",
    value: "Start z celem",
    note: "Ustalamy poziom, priorytety i kolejne kroki",
  },
  {
    label: "Materia≈Çy po lekcji",
    value: "Podsumowania",
    note: "S≈Çownictwo i kr√≥tkie zadania do utrwalenia",
  },
];

const featuredTestimonials = testimonials.filter((item) => item.featuredHome).slice(0, 2);
const homeTestimonials =
  featuredTestimonials.length > 0 ? featuredTestimonials : testimonials.slice(0, 2);

const homeFaqs = [
  {
    question: "Ile kosztuje kurs jƒôzykowy w Lingua Legionowo?",
    answer: "Ceny zale≈ºƒÖ od formatu zajƒôƒá. Lekcje indywidualne od 100-130 z≈Ç za 45-60 min, zajƒôcia w mini-grupach od 55-85 z≈Ç za osobƒô. Szczeg√≥≈Çowy cennik znajdziesz na stronie Cennik.",
  },
  {
    question: "Czy oferujecie zajƒôcia online?",
    answer: "Tak, prowadzimy lekcje online z lektorem na ≈ºywo. Zajƒôcia odbywajƒÖ siƒô przez platformƒô wideo z wykorzystaniem wsp√≥lnych materia≈Ç√≥w i tablicy interaktywnej.",
  },
  {
    question: "Od jakiego wieku przyjmujecie dzieci?",
    answer: "Przyjmujemy dzieci od oko≈Ço 6-7 lat (klasa 1). Dla m≈Çodszych dzieci polecamy zajƒôcia w mini-grupach, kt√≥re pomagajƒÖ w oswojeniu siƒô z jƒôzykiem.",
  },
  {
    question: "Jak wyglƒÖda pierwsza lekcja?",
    answer: "Zaczynamy od bezp≈Çatnej konsultacji i diagnozy poziomu. Poznajemy Twoje cele, sprawdzamy umiejƒôtno≈õci i proponujemy plan nauki dopasowany do potrzeb.",
  },
  {
    question: "Czy przygotowujecie do egzamin√≥w Cambridge i matury?",
    answer: "Tak, przygotowujemy do egzamin√≥w Cambridge (FCE, CAE, CPE), egzaminu √≥smoklasisty oraz matury na poziomie podstawowym i rozszerzonym.",
  },
  {
    question: "Ile os√≥b jest w grupie?",
    answer: "Mini-grupy liczƒÖ 2-4 osoby, co zapewnia du≈ºo czasu na m√≥wienie i indywidualnƒÖ uwagƒô lektora. Oferujemy te≈º zajƒôcia w duetach (2 osoby) i lekcje indywidualne.",
  },
];

const localBusinessSchema = {
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  name: BRAND_NAME,
  description: description,
  url: SITE_URL,
  email: CONTACT_EMAIL,
  telephone: CONTACT_PHONE,
  address: {
    "@type": "PostalAddress",
    streetAddress: BUSINESS.streetAddress,
    addressLocality: BUSINESS.city,
    postalCode: BUSINESS.postalCode,
    addressCountry: "PL",
  },
  ...(BUSINESS.geo.latitude && BUSINESS.geo.longitude && {
    geo: {
      "@type": "GeoCoordinates",
      latitude: BUSINESS.geo.latitude,
      longitude: BUSINESS.geo.longitude,
    },
  }),
  aggregateRating: {
    "@type": "AggregateRating",
    ratingValue: reviewAverage,
    reviewCount: reviewCount,
    bestRating: 5,
    worstRating: 1,
  },
  openingHoursSpecification: {
    "@type": "OpeningHoursSpecification",
    dayOfWeek: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
    opens: "08:00",
    closes: "21:00",
  },
  sameAs: [
    BUSINESS.social.facebook,
    BUSINESS.social.instagram,
  ].filter(Boolean),
};

---

<MainLayout title={title} description={description} canonical="/" structuredData={[localBusinessSchema]}>
  <link slot="head" rel="preload" href="/images/hero.webp" as="image" media="(min-width: 1024px)" type="image/webp" />
  <section class="hero-bg relative overflow-hidden">
    <!-- Subtle background elements -->
    <div class="absolute inset-0 overflow-hidden">
      <div class="absolute -top-40 -right-40 h-80 w-80 rounded-full bg-gradient-to-br from-primary/10 to-primary/3 blur-3xl animate-float"></div>
      <div class="absolute -bottom-32 -left-32 h-72 w-72 rounded-full bg-gradient-to-br from-blue-400/6 to-blue-200/4 blur-3xl animate-float" style="animation-delay: 2s;"></div>
    </div>

    <div class="relative mx-auto w-full max-w-7xl px-6 py-12 sm:py-16 lg:py-20">
      <div class="grid gap-10 lg:grid-cols-2 lg:items-center lg:gap-16">
        <div class="space-y-6">
          <div class="inline-flex items-center gap-2 rounded-full bg-white/80 backdrop-blur-sm border border-primary/20 px-3 py-1.5 shadow-sm">
            <span class="h-2 w-2 rounded-full bg-primary"></span>
            <span class="text-[10px] font-bold uppercase tracking-wider text-primary">Szko≈Ça jƒôzyk√≥w obcych i matematyki</span>
          </div>

          <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold leading-[1.15]">
            <span class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-700 bg-clip-text text-transparent">
              Jƒôzyki obce i matematyka w Legionowie
            </span>
            <span class="block mt-2 text-2xl sm:text-3xl lg:text-4xl bg-gradient-to-r from-primary to-primary-600 bg-clip-text text-transparent">
              ‚Äî plan nauki dopasowany do celu
            </span>
          </h1>

          <p class="max-w-2xl text-base text-slate-600 leading-relaxed">
            Uczymy angielskiego, francuskiego, hiszpa≈Ñskiego, niemieckiego, polskiego dla obcokrajowc√≥w,
            rosyjskiego i szwedzkiego i matematyki. Zaczynamy od kr√≥tkiej diagnozy, a potem uk≈Çadamy
            plan na 4‚Äì12 tygodni. Zajƒôcia stacjonarne w Legionowie i online dla dzieci, m≈Çodzie≈ºy,
            doros≈Çych i firm.
          </p>

          <div class="flex flex-wrap gap-3">
            <a class="btn btn-primary text-sm px-8 py-2.5 shadow-lg shadow-primary/25 hover:shadow-xl hover:shadow-primary/35" href="/oferta" data-track="cta_secondary" data-track-label="Zobacz ofertƒô">
              Zobacz ofertƒô
            </a>
          </div>

          <div class="flex flex-wrap gap-2">
            <a class="chip no-underline" href="/oferta#dla-dzieci">Dla dzieci</a>
            <a class="chip no-underline" href="/oferta#dla-mlodziezy">Dla m≈Çodzie≈ºy</a>
            <a class="chip no-underline" href="/oferta#dla-doroslych">Dla doros≈Çych</a>
            <a class="chip no-underline" href="/oferta#dla-firm">Dla firm</a>
            <a class="chip no-underline" href="/oferta#matematyka">Matematyka</a>
          </div>

          <div class="rounded-xl bg-white/60 backdrop-blur-sm border border-slate-200/60 p-5 shadow-sm">
            <ul class="list-disc space-y-2 pl-5 text-sm text-slate-600">
              {
                highlights.map((item) => (
                  <li>{item}</li>
                ))
              }
            </ul>
          </div>
        </div>

        <div class="hidden lg:block relative">
          <div class="absolute -inset-4 bg-gradient-to-br from-primary/10 via-primary/6 to-primary/3 rounded-[2rem] blur-3xl"></div>
          <div class="relative group">
            <img
              src="/images/hero.webp"
              alt="Szko≈Ça jƒôzyk√≥w obcych i matematyki Lingua Legionowo"
              loading="eager"
              width="1055"
              height="718"
              decoding="sync"
              fetchpriority="high"
              class="relative w-full rounded-xl border border-white/40 bg-white/80 backdrop-blur-sm shadow-xl shadow-slate-200/50 group-hover:shadow-2xl group-hover:-translate-y-0.5 transition-all duration-500"
            />
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section-muted py-12 lg:py-16">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="reveal flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between">
        <div class="max-w-2xl">
          <span class="kicker">Czego uczymy</span>
          <h2 class="mt-2 text-2xl sm:text-3xl">Jƒôzyki obce i matematyka w jednym miejscu</h2>
          <p class="mt-2 text-slate-600">
            Uczymy w ma≈Çych grupach i indywidualnie, stacjonarnie w Legionowie lub online.
          </p>
        </div>
        <div class="flex flex-wrap items-center gap-2.5">
          <div class="flex flex-wrap gap-2">
            {subjectChips.map((subject) => (
              <span class="chip">{subject}</span>
            ))}
          </div>
          <a class="text-sm font-semibold text-primary no-underline hover:underline decoration-2 underline-offset-4 whitespace-nowrap transition-all" href="/oferta">
            Zobacz ofertƒô ‚Üí
          </a>
        </div>
      </div>
    </div>
  </section>

  <section class="py-12 lg:py-16">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="grid gap-5 md:grid-cols-3">
        {
          proofPoints.map((item, index) => (
            <div class={`card p-5 text-center reveal reveal-delay-${(index + 1) * 100}`} style={`animation-delay: ${(index + 1) * 150}ms;`}>
              <div class="text-[10px] font-bold uppercase tracking-widest text-primary/80">
                {item.label}
              </div>
              <div class="mt-2 stat-value">{item.value}</div>
              <div class="mt-1.5 text-sm text-slate-500 leading-relaxed">{item.note}</div>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <TrustSection />

  <section class="py-12 lg:py-16">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="reveal flex flex-col gap-3 lg:flex-row lg:items-end lg:justify-between">
        <div class="max-w-3xl animate-slide-in-left">
          <span class="kicker animate-fadeIn">Opinie</span>
          <h2 class="mt-2 text-2xl sm:text-3xl">Co m√≥wiƒÖ kursanci</h2>
          <p class="mt-2 text-slate-600">
            Kr√≥tkie opinie os√≥b, kt√≥re uczƒÖ siƒô z nami stacjonarnie lub online.
          </p>
        </div>
        <div class="shrink-0 animate-slide-in-right">
          <a class="btn btn-secondary" href="/opinie">Zobacz wszystkie</a>
        </div>
      </div>

      <div class="mt-8 grid gap-5 md:grid-cols-2">
        {homeTestimonials.map((item, index) => (
          <div class={`reveal reveal-delay-${(index + 1) * 100}`} style={`animation-delay: ${(index + 1) * 150}ms;`}>
            <TestimonialCard testimonial={item} />
          </div>
        ))}
      </div>
    </div>
  </section>

  <section class="section-muted py-12 lg:py-16">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="reveal text-center max-w-2xl mx-auto animate-fadeIn">
        <span class="kicker">Proces</span>
        <h2 class="mt-2 text-2xl sm:text-3xl">Jak pracujemy</h2>
        <p class="mt-2 text-slate-600">
          Niezale≈ºnie od wybranego trybu, otrzymujesz jasny plan nauki i wsparcie na ka≈ºdym etapie.
        </p>
      </div>

      <div class="mt-10 grid gap-5 lg:grid-cols-3">
        {
          steps.map((step, index) => (
            <div class={`card p-5 text-center reveal reveal-delay-${(index + 1) * 100}`} style={`animation-delay: ${(index + 1) * 150}ms;`}>
              <div class="mx-auto mb-5 flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-primary to-primary-600 text-lg font-bold text-white shadow-md">
                {index + 1}
              </div>
              <h3 class="text-base font-bold text-slate-900">{step.title}</h3>
              <p class="mt-2 text-sm text-slate-600 leading-relaxed">{step.text}</p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <section class="py-12 lg:py-16">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="reveal relative overflow-hidden rounded-2xl border border-primary/30 bg-gradient-to-br from-primary/10 via-primary/[0.05] to-transparent p-6 lg:p-8">
        <div class="relative flex flex-col items-center justify-between gap-6 lg:flex-row">
          <div class="flex items-center gap-5">
            <div class="flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-primary/25 to-primary/10 text-3xl">
              üéÅ
            </div>
            <div>
              <p class="text-base font-semibold text-slate-900">Za polecenie nowego ucznia szko≈Çy ‚Äì</p>
              <p class="text-xl font-bold bg-gradient-to-r from-primary to-primary-600 bg-clip-text text-transparent">2 lekcje w prezencie!</p>
            </div>
          </div>
          <a href="/cennik#polecenie" class="btn btn-primary shrink-0 text-sm px-7 py-2.5 shadow-lg shadow-primary/25 hover:shadow-xl hover:shadow-primary/35">Dowiedz siƒô wiƒôcej</a>
        </div>
      </div>
    </div>
  </section>

  <section class="py-12 lg:py-16">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="reveal flex flex-col gap-3 lg:flex-row lg:items-end lg:justify-between">
        <div class="max-w-2xl animate-slide-in-left">
          <span class="kicker animate-fadeIn">Oferta</span>
          <h2 class="mt-2 text-2xl sm:text-3xl">Wybierz formƒô nauki dopasowanƒÖ do Ciebie</h2>
          <p class="mt-2 text-slate-600">
            Dwie g≈Ç√≥wne ≈õcie≈ºki to zajƒôcia stacjonarne w Legionowie i lekcje online.
          </p>
        </div>
        <div class="shrink-0 animate-slide-in-right">
          <a class="btn btn-secondary" href="/oferta">Zobacz pe≈ÇnƒÖ ofertƒô</a>
        </div>
      </div>

      <div class="mt-8 grid gap-5 md:grid-cols-2 items-start">
        {
          offerCards.map((offerCard, index) => (
            <div class={`reveal reveal-delay-${(index + 1) * 100}`} style={`animation-delay: ${(index + 1) * 150}ms;`}>
              <a
                class={`card p-6 no-underline group relative overflow-hidden block ${offerCard.featured ? "bg-gradient-to-br from-primary/[0.08] to-transparent shadow-lg shadow-primary/10" : ""}`}
                href={offerCard.href}
              >
                <div class="relative z-10">
                  {offerCard.featured && (
                    <div class="flex items-center gap-2 mb-2">
                      <span class="text-xs font-bold uppercase tracking-wider text-primary">‚úì Polecane</span>
                    </div>
                  )}
                  <h3 class="text-xl font-bold text-slate-900 group-hover:text-primary transition-colors duration-200">{offerCard.title}</h3>
                  <p class="mt-2 text-slate-600 leading-relaxed">{offerCard.text}</p>
                  <span class="mt-4 inline-flex items-center gap-2 text-sm font-bold text-primary group-hover:gap-3 transition-all duration-200">
                    Poznaj szczeg√≥≈Çy
                    <svg class="h-4 w-4 group-hover:translate-x-1 transition-transform duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                    </svg>
                  </span>
                </div>
              </a>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <FaqSection
    title="Czƒôsto zadawane pytania"
    items={homeFaqs}
    id="faq"
  />

  <CTASection
    title="Gotowy na naukƒô jƒôzyk√≥w obcych lub matematyki w Legionowie?"
    description="Napisz do nas ‚Äî zaproponujemy terminy konsultacji i plan nauki dopasowany do Twojego celu (stacjonarnie lub online)."
    note="Odpowiadamy najszybciej, jak to mo≈ºliwe."
    secondaryLabel={null}
  />

  <script is:inline>
    // Scroll reveal animation using IntersectionObserver
    document.addEventListener('DOMContentLoaded', () => {
      const reveals = document.querySelectorAll('.reveal');

      if ('IntersectionObserver' in window) {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('active');
              observer.unobserve(entry.target);
            }
          });
        }, {
          root: null,
          threshold: 0.1,
          rootMargin: "0px 0px -50px 0px" // Trigger when element is slightly up from bottom
        });

        reveals.forEach((reveal) => {
          observer.observe(reveal);
        });
      } else {
        // Fallback for older browsers
        reveals.forEach((reveal) => reveal.classList.add('active'));
      }
    });
  </script>
</MainLayout>
