---
import MainLayout from "../layouts/MainLayout.astro";
import CTASection from "../components/CTASection.astro";
import TeacherCard from "../components/TeacherCard.astro";
import TestimonialCard from "../components/TestimonialCard.astro";
import TrustSection from "../components/TrustSection.astro";
import { teachers } from "../data/teachers";
import { taughtLanguages } from "../data/subjects";
import testimonials from "../data/testimonials.json";
import {
  BRAND_NAME,
  CTA_PRIMARY_HREF,
  CTA_PRIMARY_LABEL,
  CTA_PRIMARY_REL,
  CTA_PRIMARY_TARGET,
} from "../config/site";

const languagesList = new Intl.ListFormat("pl", {
  style: "long",
  type: "conjunction",
}).format(taughtLanguages);

const title = `Lingua Legionowo — szkoła językowa i matematyka w Legionowie | ${BRAND_NAME}`;
const description =
  `Szkoła języków obcych i matematyki w Legionowie. Uczymy ${languagesList} i prowadzimy zajęcia ` +
  "stacjonarne oraz online. Umów bezpłatną diagnozę i plan nauki.";

const previewTeachers = teachers.slice(0, 4);

const offerCards = [
  {
    title: "Angielski stacjonarnie",
    text: "Zajęcia twarzą w twarz w Legionowie. Bezpośredni kontakt i pełna koncentracja.",
    href: "/angielski-stacjonarnie",
    featured: true,
  },
  {
    title: "Angielski online",
    text: "Lekcje zdalne z lektorem na żywo. Elastyczne godziny i nacisk na mówienie.",
    href: "/angielski-online",
    featured: false,
  },
];

const steps = [
  {
    title: "Rozmowa i diagnoza",
    text: "Poznajemy Twój cel, poziom i preferowany tryb zajęć. Ustalamy priorytety.",
  },
  {
    title: "Plan nauki i materiały",
    text: "Dostajesz plan na 4–12 tygodni z konkretnymi tematami, słownictwem i ćwiczeniami.",
  },
  {
    title: "Lekcje + feedback",
    text: "Na zajęciach mówisz od pierwszych minut. Po lekcji dostajesz wskazówki i zadania.",
  },
];

const highlights = [
  "Plan na 4–12 tygodni",
  "Feedback po każdej lekcji",
  "Stacjonarnie (Legionowo) i online",
];

const subjectChips = ["Angielski", "Inne języki", "Matematyka"];

const reviewCount = testimonials.length;
const reviewAverage = reviewCount
  ? (testimonials.reduce((sum, item) => sum + item.rating, 0) / reviewCount).toFixed(1)
  : "—";

const proofPoints = [
  {
    label: "Ocena kursantów",
    value: `${reviewAverage}/5`,
    note: `Na podstawie ${reviewCount} opinii na stronie`,
  },
  {
    label: "Diagnoza + plan",
    value: "Start z celem",
    note: "Ustalamy poziom, priorytety i kolejne kroki",
  },
  {
    label: "Materiały po lekcji",
    value: "Podsumowania",
    note: "Słownictwo i krótkie zadania do utrwalenia",
  },
];

const featuredTestimonials = testimonials.filter((item) => item.featuredHome).slice(0, 2);
const homeTestimonials =
  featuredTestimonials.length > 0 ? featuredTestimonials : testimonials.slice(0, 2);

// Tailwind class constants
const btnBase = "inline-flex items-center justify-center gap-2 rounded-full px-6 py-2.5 text-sm font-medium transition-colors duration-200";
const btnPrimary = `${btnBase} bg-primary text-white hover:bg-primary-600`;
const btnSecondary = `${btnBase} border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 hover:text-slate-900`;
const card = "rounded-xl border border-slate-200/80 bg-white transition-all duration-200 hover:border-slate-200 hover:shadow-soft";
const cardInteractive = `${card} p-6`;
const chip = "inline-flex items-center rounded-full border border-slate-200/80 bg-white px-3 py-1 text-xs font-medium text-slate-600";
const statCard = "rounded-xl border border-slate-200/80 bg-white p-5";
const kicker = "text-sm font-semibold uppercase tracking-wider text-primary";
---

<MainLayout title={title} description={description} canonical="/">
  <section class="bg-hero-gradient">
    <div class="mx-auto w-full max-w-7xl px-6 py-10 sm:py-14 lg:py-16">
      <div class="grid gap-8 lg:grid-cols-2 lg:items-center lg:gap-12">
        <div>
          <span class={kicker}>Szkoła języków obcych i matematyki</span>
          <h1 class="mt-4">
            Języki obce i matematyka w Legionowie — plan nauki dopasowany do celu
          </h1>
          <p class="mt-5 max-w-2xl text-lg text-slate-600 leading-relaxed">
            Uczymy {languagesList} i matematyki. Zaczynamy od krótkiej diagnozy, a potem układamy plan
            na 4–12 tygodni. Zajęcia stacjonarne w Legionowie i online dla dzieci, młodzieży, dorosłych
            i firm.
          </p>

          <div class="mt-6">
            <a class={btnPrimary} href="/oferta" data-track="cta_secondary" data-track-label="Zobacz ofertę">
              Zobacz ofertę
            </a>
          </div>

          <div class="mt-4 flex flex-wrap gap-1.5">
            <a class={`${chip} no-underline hover:border-slate-300 hover:text-slate-900 transition-colors duration-150`} href="/oferta#dla-dzieci">Dla dzieci</a>
            <a class={`${chip} no-underline hover:border-slate-300 hover:text-slate-900 transition-colors duration-150`} href="/oferta#dla-mlodziezy">Dla młodzieży</a>
            <a class={`${chip} no-underline hover:border-slate-300 hover:text-slate-900 transition-colors duration-150`} href="/oferta#dla-doroslych">Dla dorosłych</a>
            <a class={`${chip} no-underline hover:border-slate-300 hover:text-slate-900 transition-colors duration-150`} href="/oferta#dla-firm">Dla firm</a>
            <a class={`${chip} no-underline hover:border-slate-300 hover:text-slate-900 transition-colors duration-150`} href="/oferta#matematyka">Matematyka</a>
          </div>

          <ul class="mt-8 space-y-2 text-sm text-slate-600">
            {
              highlights.map((item) => (
                <li class="flex items-center gap-2.5">
                  <svg class="h-4 w-4 text-primary flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                  </svg>
                  <span>{item}</span>
                </li>
              ))
            }
          </ul>
        </div>

        <div class="hidden lg:block">
          <img
            src="/images/hero.svg"
            alt="Szkoła języków obcych i matematyki Lingua Legionowo"
            loading="eager"
            width="600"
            height="400"
            decoding="async"
            fetchpriority="high"
            class="w-full rounded-xl border border-slate-200/80 bg-white shadow-soft"
          />
        </div>
      </div>
    </div>
  </section>

  <section class="py-8 lg:py-10 bg-slate-50/60">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between">
        <div>
          <span class={kicker}>Czego uczymy</span>
          <h2 class="mt-2">Języki obce i matematyka w jednym miejscu</h2>
          <p class="mt-2 max-w-2xl text-slate-600">
            Uczymy w małych grupach i indywidualnie, stacjonarnie w Legionowie lub online.
          </p>
        </div>
        <div class="flex items-center gap-3">
          <div class="flex flex-wrap gap-1.5">
            {subjectChips.map((subject) => <span class={chip}>{subject}</span>)}
          </div>
          <a class="text-sm font-medium text-primary no-underline hover:underline whitespace-nowrap" href="/oferta">
            Zobacz ofertę →
          </a>
        </div>
      </div>
    </div>
  </section>

  <section class="py-8 lg:py-10">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="grid gap-4 md:grid-cols-3">
        {
          proofPoints.map((item) => (
            <div class={`${statCard} text-center`}>
              <div class="text-[10px] font-semibold uppercase tracking-wider text-primary">
                {item.label}
              </div>
              <div class="mt-2 text-xl font-bold text-slate-900">{item.value}</div>
              <div class="mt-1.5 text-sm text-slate-500">{item.note}</div>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <TrustSection />

  <section class="py-10 lg:py-14">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="flex flex-col gap-3 lg:flex-row lg:items-end lg:justify-between">
        <div>
          <span class={kicker}>Opinie</span>
          <h2 class="mt-2">Co mówią kursanci</h2>
          <p class="mt-2 max-w-3xl text-slate-600">
            Krótkie opinie osób, które uczą się z nami stacjonarnie lub online.
          </p>
        </div>
        <div class="shrink-0">
          <a class={btnSecondary} href="/opinie">Zobacz wszystkie</a>
        </div>
      </div>

      <div class="mt-6 grid gap-4 md:grid-cols-2">
        {homeTestimonials.map((item) => (
          <TestimonialCard testimonial={item} />
        ))}
      </div>
    </div>
  </section>

  <section class="py-10 lg:py-14">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="flex flex-col gap-3 lg:flex-row lg:items-end lg:justify-between">
        <div>
          <span class={kicker}>Nasi lektorzy</span>
          <h2 class="mt-2">Poznaj zespół, który prowadzi zajęcia</h2>
          <p class="mt-2 max-w-3xl text-slate-600">
            Doświadczeni lektorzy języków obcych i matematyki prowadzą zajęcia dopasowane do Twojego
            poziomu i celu.
          </p>
        </div>
        <div class="shrink-0">
          <a class={btnSecondary} href="/nasi-lektorzy">Zobacz wszystkich</a>
        </div>
      </div>

      <div class="mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4">
        {
          previewTeachers.map((teacher, index) => (
            <TeacherCard teacher={teacher} loading={index === 0 ? "eager" : "lazy"} />
          ))
        }
      </div>
    </div>
  </section>

  <section class="py-10 lg:py-14 bg-slate-50/60">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="text-center">
        <span class={kicker}>Proces</span>
        <h2 class="mt-2">Jak pracujemy</h2>
        <p class="mx-auto mt-2 max-w-2xl text-slate-600">
          Niezależnie od wybranego trybu, otrzymujesz jasny plan nauki i wsparcie na każdym etapie.
        </p>
      </div>

      <div class="mt-6 grid gap-4 lg:grid-cols-3">
        {
          steps.map((step, index) => (
            <div class={`${card} p-5 text-center`}>
              <div class="mx-auto mb-4 flex h-8 w-8 items-center justify-center rounded-full bg-primary text-sm font-semibold text-white">
                {index + 1}
              </div>
              <h3 class="text-base font-semibold text-slate-900">{step.title}</h3>
              <p class="mt-2 text-sm text-slate-600">{step.text}</p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <section class="py-10 lg:py-14">
    <div class="mx-auto w-full max-w-7xl px-6">
      <div class="flex flex-col gap-3 lg:flex-row lg:items-end lg:justify-between">
        <div>
          <span class={kicker}>Oferta</span>
          <h2 class="mt-2">Wybierz formę nauki dopasowaną do Ciebie</h2>
          <p class="mt-2 max-w-2xl text-slate-600">
            Dwie główne ścieżki to zajęcia stacjonarne w Legionowie i lekcje online.
          </p>
        </div>
        <div class="shrink-0">
          <a class={btnSecondary} href="/oferta">Zobacz pełną ofertę</a>
        </div>
      </div>

      <div class="mt-6 grid gap-4 md:grid-cols-2">
        {
          offerCards.map((offerCard) => (
            <a
              class={`${cardInteractive} no-underline group ${offerCard.featured ? "ring-1 ring-primary/20" : ""}`}
              href={offerCard.href}
            >
              {offerCard.featured && <span class="inline-block rounded-full px-2.5 py-0.5 text-[10px] font-semibold mb-3 bg-primary/10 text-primary">Polecane</span>}
              <h3 class="text-base font-semibold text-slate-900">{offerCard.title}</h3>
              <p class="mt-2 text-sm text-slate-600">{offerCard.text}</p>
              <span class="mt-3 inline-flex items-center gap-1.5 text-sm font-medium text-primary group-hover:gap-2.5 transition-all duration-200">
                Poznaj szczegóły
                <svg class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                </svg>
              </span>
            </a>
          ))
        }
      </div>
    </div>
  </section>

  <CTASection
    title="Gotowy na naukę języków obcych lub matematyki w Legionowie?"
    description="Napisz do nas — zaproponujemy terminy konsultacji i plan nauki dopasowany do Twojego celu (stacjonarnie lub online)."
    note="Odpowiadamy najszybciej, jak to możliwe."
    secondaryLabel={null}
  />
</MainLayout>
