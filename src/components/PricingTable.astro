---
interface Props {
  title: string;
  subtitle?: string;
  columns?: string[];
  rows?: string[][];
  footnote?: string;
  /** ID for the table for accessibility */
  tableId?: string;
}

const {
  title,
  subtitle,
  columns = [],
  rows = [],
  footnote,
  tableId = `pricing-table-${Math.random().toString(36).slice(2, 9)}`,
} = Astro.props;

const captionId = `${tableId}-caption`;

---

<section class="card p-6" aria-labelledby={captionId}>
  <h3 id={captionId} class="text-base font-bold text-slate-900">{title}</h3>
  {subtitle && <p class="mt-2 text-sm text-slate-600">{subtitle}</p>}

  <div class="mt-5 relative">
    <div
      class="pointer-events-none absolute inset-y-0 right-0 w-10 bg-gradient-to-l from-white to-transparent md:hidden"
      aria-hidden="true"
    ></div>
    <div class="overflow-x-auto pb-2" tabindex="0" role="region" aria-label={`Tabela: ${title}`}>
      <table class="w-full min-w-[520px] text-left text-sm" aria-describedby={subtitle ? `${tableId}-subtitle` : undefined}>
        {subtitle && <caption id={`${tableId}-subtitle`} class="sr-only">{subtitle}</caption>}
        <thead>
          <tr
            class="border-b border-slate-100 text-[10px] font-medium uppercase tracking-wider text-slate-500"
          >
            {
              columns.map((c, i) => (
                <th class="py-3 pr-4" scope="col" id={`${tableId}-col-${i}`}>
                  {c}
                </th>
              ))
            }
          </tr>
        </thead>
        <tbody>
          {
            rows.map((r, rowIndex) => (
              <tr class="border-b border-slate-100/80 last:border-0">
                {r.map((cell, cellIndex) => (
                  cellIndex === 0 ? (
                    <th
                      scope="row"
                      class="py-3 pr-4 font-semibold text-slate-900"
                      id={`${tableId}-row-${rowIndex}`}
                    >
                      {cell}
                    </th>
                  ) : (
                    <td
                      class="py-3 pr-4 text-slate-600"
                      headers={`${tableId}-col-${cellIndex} ${tableId}-row-${rowIndex}`}
                    >
                      {cell}
                    </td>
                  )
                ))}
              </tr>
            ))
          }
        </tbody>
      </table>
    </div>
    <p class="mt-2 text-xs text-slate-500 md:hidden" aria-live="polite">
      Przesuń tabelę w bok, aby zobaczyć wszystkie kolumny.
    </p>
  </div>

  {footnote && <p class="mt-4 text-xs text-slate-500">{footnote}</p>}
</section>
