---
import { BRAND_NAME, GOOGLE_REVIEWS, YEARS_IN_OPERATION } from "../config/site";
import { teachers } from "../data/teachers";
import {
  GOOGLE_REVIEW_HIGHLIGHTS,
  TEACHER_CREDENTIALS,
  TEACHING_APPROACH,
} from "../data/trust";

const teacherCount = teachers.length;
const languageCount = new Set(teachers.flatMap((teacher) => teacher.languages)).size;

const hasGoogleReviews = Boolean(GOOGLE_REVIEWS.url);
const ratingDisplay =
  typeof GOOGLE_REVIEWS.rating === "number"
    ? `${GOOGLE_REVIEWS.rating.toFixed(1).replace(".", ",")}/5`
    : "—";
const countDisplay =
  typeof GOOGLE_REVIEWS.count === "number"
    ? new Intl.NumberFormat("pl-PL").format(GOOGLE_REVIEWS.count)
    : "—";

const reviewCtaHref = GOOGLE_REVIEWS.url || "/opinie";
const reviewCtaLabel = hasGoogleReviews ? "Zobacz opinie w Google" : "Zobacz opinie kursantów";

const trustStats = [
  { label: "Lata działalności", value: YEARS_IN_OPERATION || "—" },
  { label: "Lektorzy", value: String(teacherCount) },
  { label: "Języki", value: String(languageCount) },
];

---

<section class="section section-muted">
  <div class="container-site">
    <div class="grid gap-4 lg:grid-cols-3">
      <div class="card p-5 flex flex-col">
        <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Opinie</div>
        <h3 class="mt-2 text-base font-bold text-slate-900">Opinie z Google</h3>
        <p class="mt-2 text-sm text-slate-600">
          Sprawdź, co o nas mówią kursanci i rodzice.
        </p>

        <div class="mt-4 grid gap-2 sm:grid-cols-2">
          <div class="rounded-lg border border-slate-100 bg-slate-50/50 p-3 text-center">
            <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Ocena</div>
            <div class="mt-1 text-xl font-bold text-slate-900">{ratingDisplay}</div>
          </div>
          <div class="rounded-lg border border-slate-100 bg-slate-50/50 p-3 text-center">
            <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Opinii</div>
            <div class="mt-1 text-xl font-bold text-slate-900">{countDisplay}</div>
          </div>
        </div>

        {GOOGLE_REVIEW_HIGHLIGHTS.length > 0 && (
          <div class="mt-4 space-y-2">
            {GOOGLE_REVIEW_HIGHLIGHTS.slice(0, 2).map((item) => (
              <div class="rounded-lg border border-slate-100 bg-slate-50/50 p-2.5 text-sm text-slate-600">
                <p class="leading-relaxed text-xs">"{item.text}"</p>
                {item.author && <p class="mt-1 text-[10px] font-medium text-slate-400">— {item.author}</p>}
              </div>
            ))}
          </div>
        )}

        <div class="mt-auto pt-4">
          <a class="btn btn-secondary w-full text-xs" href={reviewCtaHref} target={hasGoogleReviews ? "_blank" : undefined} rel={hasGoogleReviews ? "noopener noreferrer" : undefined}>
            {reviewCtaLabel}
          </a>
        </div>
      </div>

      <div class="card p-5 flex flex-col">
        <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Zespół</div>
        <h3 class="mt-2 text-base font-bold text-slate-900">Zespół i podejście</h3>
        <p class="mt-2 text-sm text-slate-600">
          Uczysz się z lektorami, którzy dopasowują plan do Twoich potrzeb.
        </p>

        <div class="mt-4 grid gap-2 grid-cols-3">
          {trustStats.map((item) => (
            <div class="rounded-lg border border-slate-100 bg-slate-50/50 p-2 text-center">
              <div class="text-[9px] font-medium uppercase tracking-wider text-slate-400">{item.label}</div>
              <div class="mt-0.5 text-base font-bold text-slate-900">{item.value}</div>
            </div>
          ))}
        </div>

        <div class="mt-4">
          <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Podejście</div>
          <ul class="mt-2 space-y-1.5 text-xs text-slate-600">
            {TEACHING_APPROACH.map((item) => (
              <li class="flex items-start gap-1.5">
                <span class="mt-1 h-1 w-1 flex-shrink-0 rounded-full bg-primary/60" aria-hidden="true"></span>
                <span>{item}</span>
              </li>
            ))}
          </ul>
        </div>

        {TEACHER_CREDENTIALS.length > 0 && (
          <div class="mt-4">
            <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Kwalifikacje</div>
            <ul class="mt-2 space-y-1.5 text-xs text-slate-600">
              {TEACHER_CREDENTIALS.slice(0, 3).map((item) => (
                <li class="flex items-start gap-1.5">
                  <span class="mt-1 h-1 w-1 flex-shrink-0 rounded-full bg-primary/60" aria-hidden="true"></span>
                  <span>{item}</span>
                </li>
              ))}
            </ul>
          </div>
        )}

        <div class="mt-auto pt-4 flex flex-wrap gap-2">
          <a class="btn btn-primary text-xs" href="/nasi-lektorzy">Poznaj lektorów</a>
          <a class="btn btn-secondary text-xs" href="/o-nas">O nas</a>
        </div>
      </div>

      <div class="card p-5 flex flex-col">
        <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Lokalizacja</div>
        <h3 class="mt-2 text-base font-bold text-slate-900">Szkoła i zajęcia</h3>
        <p class="mt-2 text-sm text-slate-600">
          Chcesz zobaczyć szkołę na miejscu? Umów konsultację — pokażemy sale i opowiemy o organizacji.
        </p>

        <div class="mt-4 rounded-lg border border-slate-100 bg-slate-50/50 p-3">
          <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Co oferujemy</div>
          <ul class="mt-2 space-y-1.5 text-xs text-slate-600">
            <li class="flex items-start gap-1.5">
              <span class="mt-1 h-1 w-1 flex-shrink-0 rounded-full bg-primary/60" aria-hidden="true"></span>
              <span>Zajęcia stacjonarne w Legionowie</span>
            </li>
            <li class="flex items-start gap-1.5">
              <span class="mt-1 h-1 w-1 flex-shrink-0 rounded-full bg-primary/60" aria-hidden="true"></span>
              <span>Lekcje online z lektorem na żywo</span>
            </li>
            <li class="flex items-start gap-1.5">
              <span class="mt-1 h-1 w-1 flex-shrink-0 rounded-full bg-primary/60" aria-hidden="true"></span>
              <span>Małe grupy lub zajęcia indywidualne</span>
            </li>
          </ul>
        </div>

        <div class="mt-auto pt-4">
          <a class="btn btn-secondary w-full text-xs" href="/kontakt">Umów wizytę w szkole</a>
        </div>
      </div>
    </div>
  </div>
</section>
