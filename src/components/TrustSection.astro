---
import { BRAND_NAME, GOOGLE_REVIEWS, YEARS_IN_OPERATION } from "../config/site";
import { teachers } from "../data/teachers";
import {
  GOOGLE_REVIEW_HIGHLIGHTS,
  TEACHER_CREDENTIALS,
  TEACHING_APPROACH,
} from "../data/trust";

const teacherCount = teachers.length;
const languageCount = new Set(teachers.flatMap((teacher) => teacher.languages)).size;

const hasGoogleReviews = Boolean(GOOGLE_REVIEWS.url);
const ratingDisplay =
  typeof GOOGLE_REVIEWS.rating === "number"
    ? `${GOOGLE_REVIEWS.rating.toFixed(1).replace(".", ",")}/5`
    : "—";
const countDisplay =
  typeof GOOGLE_REVIEWS.count === "number"
    ? new Intl.NumberFormat("pl-PL").format(GOOGLE_REVIEWS.count)
    : "—";

const reviewCtaHref = GOOGLE_REVIEWS.url || "/opinie";
const reviewCtaLabel = hasGoogleReviews ? "Zobacz opinie w Google" : "Zobacz opinie kursantów";

const trustStats = [
  { label: "Lata działalności", value: YEARS_IN_OPERATION || "—" },
  { label: "Lektorzy", value: String(teacherCount) },
  { label: "Języki", value: String(languageCount) },
];

// Tailwind class constants
const btnBase = "inline-flex items-center justify-center gap-2 rounded-full px-5 py-2.5 text-sm font-medium transition-colors duration-150";
const btnPrimary = `${btnBase} bg-primary text-white hover:bg-primary-600`;
const btnSecondary = `${btnBase} border border-slate-200 bg-white text-slate-600 hover:bg-slate-50 hover:text-slate-800`;
const card = "rounded-xl border border-slate-200/80 bg-white transition-all duration-200 hover:shadow-soft hover:border-slate-200";
---

<section class="py-16 lg:py-24 bg-slate-50/60">
  <div class="mx-auto w-full max-w-7xl px-6">
    <div class="text-center max-w-2xl mx-auto">
      <span class="text-[11px] font-semibold uppercase tracking-wider text-primary">Zaufanie</span>
      <h2 class="mt-4">Dlaczego kursanci wybierają {BRAND_NAME}</h2>
      <p class="mt-4 text-slate-600">
        Łączymy lokalną szkołę z elastycznością zajęć online. Poniżej znajdziesz najważniejsze
        sygnały zaufania i praktyczne informacje o zespole.
      </p>
    </div>

    <div class="mt-10 grid gap-5 lg:grid-cols-3">
      <div class={`${card} p-6`}>
        <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Opinie</div>
        <h3 class="mt-3 text-lg font-bold text-slate-900">Opinie z Google</h3>
        <p class="mt-3 text-sm text-slate-600">
          Sprawdź, co o nas mówią kursanci i rodzice. Opinie pomagają podjąć decyzję o starcie.
        </p>

        <div class="mt-5 grid gap-3 sm:grid-cols-2">
          <div class="rounded-xl border border-slate-100 bg-slate-50/50 p-4 text-center">
            <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Ocena</div>
            <div class="mt-2 text-2xl font-bold text-slate-900">{ratingDisplay}</div>
            <div class="mt-1 text-xs text-slate-400">Google Reviews</div>
          </div>
          <div class="rounded-xl border border-slate-100 bg-slate-50/50 p-4 text-center">
            <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Liczba opinii</div>
            <div class="mt-2 text-2xl font-bold text-slate-900">{countDisplay}</div>
            <div class="mt-1 text-xs text-slate-400">Google Reviews</div>
          </div>
        </div>

        {GOOGLE_REVIEW_HIGHLIGHTS.length > 0 && (
          <div class="mt-5">
            <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">
              Opinie z Google
            </div>
            <div class="mt-3 grid gap-2">
              {GOOGLE_REVIEW_HIGHLIGHTS.map((item) => (
                <div class="rounded-xl border border-slate-100 bg-slate-50/50 p-3 text-sm text-slate-600">
                  <p class="leading-relaxed">"{item.text}"</p>
                  {item.author && <p class="mt-2 text-xs font-medium text-slate-500">— {item.author}</p>}
                </div>
              ))}
            </div>
          </div>
        )}

        <div class="mt-6">
          <a class={`${btnSecondary} w-full`} href={reviewCtaHref} target={hasGoogleReviews ? "_blank" : undefined} rel={hasGoogleReviews ? "noopener noreferrer" : undefined}>
            {reviewCtaLabel}
          </a>
        </div>
      </div>

      <div class={`${card} p-6`}>
        <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Poznaj lektorów</div>
        <h3 class="mt-3 text-lg font-bold text-slate-900">Zespół i podejście</h3>
        <p class="mt-3 text-sm text-slate-600">
          Uczysz się z lektorami, którzy prowadzą zajęcia stacjonarne i online oraz dopasowują plan
          do Twoich potrzeb.
        </p>

        <div class="mt-5 grid gap-2 sm:grid-cols-3">
          {trustStats.map((item) => (
            <div class="rounded-xl border border-slate-100 bg-slate-50/50 p-3 text-center">
            <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">
              {item.label}
            </div>
              <div class="mt-1 text-lg font-bold text-slate-900">{item.value}</div>
            </div>
          ))}
        </div>

        <div class="mt-5">
          <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Podejście</div>
          <ul class="mt-3 space-y-2 text-sm text-slate-600">
            {TEACHING_APPROACH.map((item) => (
              <li class="flex items-start gap-2">
                <span class="mt-1.5 h-1.5 w-1.5 flex-shrink-0 rounded-full bg-primary/60" aria-hidden="true"></span>
                <span>{item}</span>
              </li>
            ))}
          </ul>
        </div>

        {TEACHER_CREDENTIALS.length > 0 && (
          <div class="mt-5">
            <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">
              Kwalifikacje
            </div>
            <ul class="mt-3 space-y-2 text-sm text-slate-600">
              {TEACHER_CREDENTIALS.map((item) => (
                <li class="flex items-start gap-2">
                  <span class="mt-1.5 h-1.5 w-1.5 flex-shrink-0 rounded-full bg-primary/60" aria-hidden="true"></span>
                  <span>{item}</span>
                </li>
              ))}
            </ul>
          </div>
        )}

        <div class="mt-6 flex flex-wrap gap-3">
          <a class={btnPrimary} href="/nasi-lektorzy">Poznaj lektorów</a>
          <a class={btnSecondary} href="/o-nas">O nas</a>
        </div>
      </div>

      <div class={`${card} p-6`}>
        <div class="text-[10px] font-medium uppercase tracking-wider text-slate-400">Zdjęcia</div>
        <h3 class="mt-3 text-lg font-bold text-slate-900">Szkoła i zajęcia</h3>
        <p class="mt-3 text-sm text-slate-600">
          Chcesz zobaczyć szkołę na miejscu? Umów konsultację — pokażemy sale i opowiemy o organizacji zajęć.
        </p>
        <div class="mt-6">
          <a class={`${btnSecondary} w-full`} href="/kontakt">Umów wizytę w szkole</a>
        </div>
      </div>
    </div>
  </div>
</section>
