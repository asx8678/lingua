---
import MainLayout from "../layouts/MainLayout.astro";
import CTASection from "./CTASection.astro";
import FaqSection from "./FaqSection.astro";
import {
  BRAND_NAME,
  CTA_PRIMARY_HREF,
  CTA_PRIMARY_LABEL,
  CTA_PRIMARY_REL,
  CTA_PRIMARY_TARGET,
  getSecondaryCta,
  type CtaVariant,
  generateBreadcrumbSchema,
  SITE_URL,
} from "../config/site";
import type { LandingPageData } from "../data/landing-pages";

interface Props {
  data: LandingPageData;
}

const { data } = Astro.props;
const fullTitle = `${data.title} | ${BRAND_NAME}`;
const ctaVariant: CtaVariant = "english";
const secondaryCta = getSecondaryCta(ctaVariant);

const faqJsonLd = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  mainEntity: data.faqs.map((item) => ({
    "@type": "Question",
    name: item.question,
    acceptedAnswer: {
      "@type": "Answer",
      text: item.answer,
    },
  })),
};

const breadcrumbSchema = generateBreadcrumbSchema([
  { name: "Strona główna", url: "/" },
  { name: "Oferta", url: "/oferta" },
  { name: data.kicker },
]);

const courseJsonLd = {
  "@context": "https://schema.org",
  "@type": "Course",
  name: data.h1,
  description: data.description,
  provider: {
    "@type": "Organization",
    name: BRAND_NAME,
    url: SITE_URL,
  },
};
---

<MainLayout
  title={fullTitle}
  description={data.description}
  canonical={data.canonical}
  structuredData={[faqJsonLd, breadcrumbSchema, courseJsonLd]}
>
  <section class="hero-bg">
    <div class="container-site py-16 sm:py-20">
      <div class="grid gap-10 lg:grid-cols-2 lg:items-center">
        <div>
          <span class="kicker">{data.kicker}</span>
          <h1 class="mt-6">{data.h1}</h1>
          <p class="mt-6 max-w-2xl text-lg">
            {data.intro}
          </p>
          <div class="mt-8 flex flex-wrap gap-3">
            <a
              class="btn btn-primary"
              href={CTA_PRIMARY_HREF}
              target={CTA_PRIMARY_TARGET}
              rel={CTA_PRIMARY_REL}
              data-track="cta_primary"
              data-track-label={CTA_PRIMARY_LABEL}
            >
              {CTA_PRIMARY_LABEL}
            </a>
            {
              secondaryCta && (
                <a
                  class="btn btn-secondary"
                  href={secondaryCta.href}
                  data-track="cta_secondary"
                  data-track-label={secondaryCta.label}
                >
                  {secondaryCta.label}
                </a>
              )
            }
          </div>
        </div>

        <div class="relative">
          <img
            src="/images/hero.svg"
            alt={data.h1}
            loading="eager"
            width="600"
            height="400"
            class="w-full rounded-3xl border border-slate-200 shadow-soft"
          />
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container-site">
      <h2>Dlaczego {BRAND_NAME}?</h2>
      <p class="mt-4 max-w-3xl">
        Jesteśmy lokalną szkołą językową, która rozumie potrzeby mieszkańców Legionowa. Bez dojazdów
        do Warszawy — ucz się blisko domu.
      </p>
      <div class="mt-8 grid gap-6 md:grid-cols-2">
        {
          data.benefits.map((item) => (
            <div class="card p-6">
              <h3 class="text-lg font-extrabold text-slate-900">{item.title}</h3>
              <p class="mt-2 text-sm text-slate-600">{item.text}</p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <section class="section section-muted">
    <div class="container-site">
      <h2>Nasza oferta</h2>
      <p class="mt-4 max-w-3xl">
        Wybierz formę nauki dopasowaną do swoich potrzeb i możliwości czasowych.
      </p>
      <div class="mt-8 grid gap-6 md:grid-cols-2">
        {
          data.offers.map((item) => (
            <a class="card p-6 no-underline transition hover:-translate-y-0.5" href={item.href}>
              <h3 class="text-lg font-extrabold text-slate-900">{item.title}</h3>
              <p class="mt-2 text-sm text-slate-600">{item.text}</p>
              <span class="mt-4 inline-flex text-sm font-bold text-primary">
                Dowiedz się więcej →
              </span>
            </a>
          ))
        }
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container-site">
      <div class="grid gap-10 lg:grid-cols-2 lg:items-start">
        <div>
          <h2>Dla kogo są nasze kursy?</h2>
          <p class="mt-4">
            Prowadzimy zajęcia dla różnych grup wiekowych i na różnych poziomach zaawansowania.
          </p>
          <ul class="mt-6 space-y-3">
            {
              data.targetAudience.map((item) => (
                <li class="flex items-start gap-3 text-sm text-slate-600">
                  <span
                    class="mt-1.5 h-2 w-2 flex-shrink-0 rounded-full bg-primary"
                    aria-hidden="true"
                  />
                  <span>
                    <strong>{item.label}</strong> — {item.description}
                  </span>
                </li>
              ))
            }
          </ul>
        </div>
        <div class="card p-6">
          <h3 class="text-lg font-extrabold text-slate-900">{data.locationCard.title}</h3>
          <p class="mt-4 text-sm text-slate-600">
            {data.locationCard.intro}
          </p>
          <ul class="mt-4 list-disc space-y-2 pl-5 text-sm text-slate-600">
            {data.locationCard.features.map((feature) => <li>{feature}</li>)}
          </ul>
          <div class="mt-6">
            <a
              class="btn btn-primary"
              href={CTA_PRIMARY_HREF}
              target={CTA_PRIMARY_TARGET}
              rel={CTA_PRIMARY_REL}
              data-track="cta_primary"
              data-track-label={CTA_PRIMARY_LABEL}
            >
              {CTA_PRIMARY_LABEL}
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <FaqSection title={`${data.kicker} — pytania i odpowiedzi`} items={data.faqs} />

  <CTASection
    title={data.cta.title}
    description={data.cta.description}
    note={data.cta.note}
    variant={ctaVariant}
  />
</MainLayout>
